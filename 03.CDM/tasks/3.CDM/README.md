# Построение витрины (слоя CDM)

Мы собрали исторический слой. Давайте теперь построем витрину под конкретный заказ бизнеса:
Пользователь хочет видеть агрегированную статистику по пользователю:

>>> [!tip] Постановка:
0. Все метрики собираем на дату: "2105-12-31 00:00:00" в разрезе пользователя:
1. id любимого товара (финальный статус позиции заказа 'pay', 'completed', 'delivered'; пользователь заплатил за него больше всего рублей) и сумма, которую пользователь заплатил;
2. Кол-во купленных товаров (финальный статус позиции заказа 'pay', 'completed', 'delivered');
3. Среднее время исполнения заказа (от появления до финального статуса) в днях;
>>>

Схема таблицы приложена ниже:
| \# | name                     | type                |
|----|--------------------------|---------------------|
| 1	 | best_sku	                | Int64[optional]     |
| 2	 | best_sku_price	        | Int64[optional]     |
| 3	 | count_pay_item	        | Int64[optional]     |
| 4	 | avg_order_completion_day	| Int64[optional]     |
| 5	 | user_id	                | Int64               |

>>> [!note] P.S.:
1. Неужели мы не все учли при построении витрины и придется обращаться к сырым данным raw слоя? (да, иногда такое происходит);
2. Как дополнительное задание, подумайте как собрать метрику: Сумма которую пользователь сэкономил(промо-акции) (финальный статус товара 'pay', 'completed', 'delivered') (Берем только покупки в рублях ;));
3. Посторайтесь использовать как можно меньше Reduce операций (красивое дерево исполнения YQL-запроса строится в нижней части экрана);
4. Таблица должна быть отсортирована по user_id.
5. Для запуска проверки, верните в функции ``get_table_path()`` путь до получившейся таблицы;
>>>     
